name: Format Issue Title

on:
  issues:
    types: [opened]

jobs:
  format-title:
    runs-on: ubuntu-latest
    if: contains(github.event.issue.body, 'ì¹´í…Œê³ ë¦¬')

    steps:
      - name: Extract category and format title
        uses: actions/github-script@v6
        with:
          script: |
            const issue = context.payload.issue;
            const body = issue.body;

            // ì¹´í…Œê³ ë¦¬ ì¶”ì¶œ
            const categoryMatch = body.match(/### ì¹´í…Œê³ ë¦¬\s*\n\s*(.+)/);
            const titleMatch = body.match(/### ì œëª©\s*\n\s*(.+)/);

            if (categoryMatch && titleMatch) {
              const category = categoryMatch[1].trim();
              const originalTitle = titleMatch[1].trim();
              
              // ì¹´í…Œê³ ë¦¬ ë§¤í•‘
              const categoryMap = {
                'FE': '[FE]',
                'BE': '[BE]',
                'LLM': '[LLM]',
                'INFRA': '[INFRA]',
                'DOCS': '[DOCS]',
                'SHARED': '[SHARED]'
              };
              
              const prefix = categoryMap[category] || `[${category}]`;
              const newTitle = `${prefix} ${originalTitle}`;
              
              // ì´ìŠˆ ì œëª© ì—…ë°ì´íŠ¸
              await github.rest.issues.update({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                title: newTitle
              });
              
              // ì¹´í…Œê³ ë¦¬ì— ë”°ë¥¸ ë¼ë²¨ ì¶”ê°€
              const labels = ['ğŸš€ feature'];
              
              // ì¹´í…Œê³ ë¦¬ë³„ ë¼ë²¨ ì¶”ê°€
              const categoryLabels = {
                'FE': 'frontend',
                'BE': 'backend', 
                'LLM': 'llm',
                'INFRA': 'infrastructure',
                'DOCS': 'documentation',
                'SHARED': 'shared'
              };
              
              if (categoryLabels[category]) {
                labels.push(categoryLabels[category]);
              }
              
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                labels: labels
              });
            }
